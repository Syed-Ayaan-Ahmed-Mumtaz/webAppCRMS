<!DOCTYPE html>
<html>

<head>
    <title>CRMS - Queries</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>

<body>
    <div class="banner">
        <img src="{{ url_for('static', filename='images/logo.svg') }}" alt="logo" class="logo">
        <h1 class="banner-text">Criminal Records Management System</h1>
    </div>

    <div class="records-container">
        <h2>Search / Filter Records</h2>
        <div style="margin-bottom: 20px; display: flex; justify-content: center; gap: 10px;">
            <a href="{{ url_for('manage_records') }}">
                <button>Go To Manage Records Page</button>
            </a>
            <a href="{{ url_for('records')}}">
                <button>Go To Records Page</button>
            </a>
            <a href="{{ url_for('logout') }}">
                <button>Log Out</button>
            </a>
        </div>
        <form method="post" action="{{ url_for('queries') }}">
            <input type="text" name="case_name" placeholder="Search By Case Name"
                value="{{ request.form.case_name or '' }}"><br>
            <input type="text" name="officer_name" placeholder="Search By Officer Name"
                value="{{ request.form.officer_name or '' }}"><br>

            <label>Status:</label>
            <select name="status">
                <option value="">Any</option>
                <option value="Open" {% if request.form.status=='Open' %}selected{% endif %}>Open</option>
                <option value="Closed" {% if request.form.status=='Closed' %}selected{% endif %}>Closed</option>
                <option value="Under Investigation" {% if request.form.status=='Under Investigation' %}selected{% endif
                    %}>Under Investigation</option>
                <option value="Arrest Made" {% if request.form.status=='Arrest Made' %}selected{% endif %}>Arrest Made
                </option>
            </select><br>

            <button type="submit">Run Query</button>
            <a href="{{ url_for('queries') }}" style="text-decoration: none;"><button type="button">Clear
                    Filters</button></a>
        </form>

        {% if records %}
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Case Name</th>
                    <th>Description</th>
                    <th>Criminal Name</th>
                    <th>Status</th>
                    <th>Officer Name</th>
                    <th>Date</th>
                </tr>
            </thead>
            <tbody>
                {% for r in records %}
                <tr>
                    <td>{{ r.id }}</td>
                    <td>{{ r.case_name }}</td>
                    <td>{{ r.description }}</td>
                    <td>{{ r.criminal_name }}</td>
                    <td>{{ r.status }}</td>
                    <td>{{ r.officer_name }}</td>
                    <td>{{ r.crime_date }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        {% if request.method == 'POST' %}
        <p>No records found matching your query.</p>
        {% endif %}
        {% endif %}
    </div>
</body>

</html>